<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2023-01-21 Sat 10:50 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Black Python formatting</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<link rel='stylesheet' type='text/css' href='css/style.css' />
<link rel='icon' type='image/png' href='/favicon.png'>
</head>
<body>
<div id="org-div-home-and-up">
                               <a accesskey="H" href="/">Home</a>
                               </div><div id="content" class="content">
<header>
<h1 class="title">Black Python formatting</h1>
</header><p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-03-19 Fri&gt;</span></span>
</p>

<p>
<b>Black</b> is the uncompromising Python code formatter. It gives you speed, determinism, and freedom from <code>pycodestyle</code> nagging about formatting. You will save time and mental energy for more important matters.
</p>

<p>
Blackened code looks the same regardless of the project you're reading. Formatting becomes transparent after a while and you can focus on the content instead.
</p>

<p>
<b>Black</b> makes code review faster by producing the smallest diffs possible.
</p>


<div id="outline-container-org6ed0f56" class="outline-2">
<h2 id="org6ed0f56">Why</h2>
<div class="outline-text-2" id="text-org6ed0f56">
<blockquote>
<p>
Black is opinionated so you don't have to be.
</p>
</blockquote>

<blockquote>
<p>
An auto-formatter that doesn't suck is all I want for Xmas!
</p>
</blockquote>

<blockquote>
<p>
At least the name is good.
</p>
</blockquote>

<p>
You can write in any style you want and autoformatting tools will make your code beautiful.
</p>

<p>
Don't waste your time arguing about code style. Black it, forget it.
</p>
</div>
</div>


<div id="outline-container-org14b4c30" class="outline-2">
<h2 id="org14b4c30">Usage</h2>
<div class="outline-text-2" id="text-org14b4c30">
</div>
<div id="outline-container-org2064783" class="outline-3">
<h3 id="org2064783">Install</h3>
<div class="outline-text-3" id="text-org2064783">
<div class="org-src-container">
<pre class="src src-sh">pip install black
</pre>
</div>
</div>
</div>

<div id="outline-container-org64491b8" class="outline-3">
<h3 id="org64491b8">Manually</h3>
<div class="outline-text-3" id="text-org64491b8">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #93a1a1;"># </span><span style="color: #93a1a1;">formats file in place</span>
black [file]

<span style="color: #93a1a1;"># </span><span style="color: #93a1a1;">just check</span>
black -c [file]

<span style="color: #93a1a1;"># </span><span style="color: #93a1a1;">just output a diff for each file</span>
black --diff [file]
</pre>
</div>
</div>
</div>

<div id="outline-container-org1ba4089" class="outline-3">
<h3 id="org1ba4089">Plugins</h3>
<div class="outline-text-3" id="text-org1ba4089">
<p>
There are plugins for anything:
</p>

<ul class="org-ul">
<li>PyCharm</li>
<li>VSCode</li>
<li>Jupiter</li>
<li>Emacs</li>
<li>Vim</li>
<li>&#x2026;</li>
</ul>

<p>
For more info have a look at <a href="https://github.com/psf/black#editor-integration">Black Github Page</a>
</p>
</div>
</div>

<div id="outline-container-org67f3ca7" class="outline-3">
<h3 id="org67f3ca7">Git hook</h3>
<div class="outline-text-3" id="text-org67f3ca7">
<p>
Use git <code>pre-commit</code> hook.
</p>

<p>
It will automatically reformat files and add them to commit.
</p>

<p>
<b>File</b>: <code>.git/hooks/pre-commit</code>
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #93a1a1;">#</span><span style="color: #93a1a1;">!/bin/</span><span style="color: #859900; font-weight: bold;">sh</span>

<span style="color: #657b83; font-weight: bold;">set</span> -e

<span style="color: #268bd2;">ROOT</span>=$(git rev-parse --show-toplevel)
<span style="color: #268bd2;">FILES</span>=$(git diff --name-status --cached | awk <span style="color: #2aa198;">'{print "$2"}'</span> | grep <span style="color: #2aa198;">'\.py'</span> | xargs -I {} <span style="color: #657b83; font-weight: bold;">echo</span> <span style="color: #2aa198;">"$ROOT/{}"</span> | paste -sd <span style="color: #2aa198;">" "</span> - || <span style="color: #657b83; font-weight: bold;">true</span>)

<span style="color: #859900; font-weight: bold;">if</span> [ -n <span style="color: #2aa198;">"$FILES"</span> ]; <span style="color: #859900; font-weight: bold;">then</span>
    black <span style="color: #2aa198;">"$FILES"</span>
    git add -u <span style="color: #2aa198;">"$FILES"</span>
<span style="color: #859900; font-weight: bold;">fi</span>
</pre>
</div>

<p>
To skip running pre commit hook, use <code>--no-verify</code>:
</p>

<p>
<code>git commit --no-verify</code>
</p>

<p>
<code>git commit --amend --no-edit --no-verify</code>
</p>
</div>
</div>

<div id="outline-container-org8c23cbf" class="outline-3">
<h3 id="org8c23cbf">CI</h3>
<div class="outline-text-3" id="text-org8c23cbf">
<p>
I think formatting should be checked in CI as well to prevent pushing unformatted code. This is the last line of defense.
</p>
</div>
</div>
</div>

<div id="outline-container-org8b4c79b" class="outline-2">
<h2 id="org8b4c79b">Configuration</h2>
<div class="outline-text-2" id="text-org8b4c79b">
<p>
It's good by default and there is not a lot of things to config. The only thing you might want to configure is max line length.
To force line length, there is an argument:
</p>

<div class="org-src-container">
<pre class="src src-sh">-l, --line-length INTEGER       How many characters per line to allow.
                                  [default: 88]
</pre>
</div>

<p>
By default black using 88 chars limit. I think it is a good choice, but as for me it's more comfortable to have old good 79 characters. Then you can fit 2 panes of code side by side on the 13 inch display.
</p>

<p>
To force some black rules, toml file can be used. Place it in any subdirectory of git project, black will look for config file in parent directories until it gets to the root of git repo.
</p>

<p>
<b>File</b>: <code>pyproject.toml</code>
</p>

<div class="org-src-container">
<pre class="src src-ini">[tool.black]
line-length = 79
</pre>
</div>
</div>
</div>


<div id="outline-container-org69504ac" class="outline-2">
<h2 id="org69504ac">Limitations</h2>
<div class="outline-text-2" id="text-org69504ac">
<ul class="org-ul">
<li>Can't split string lines
There is an issue on GitHub, it's not trivial problem but not rocket science</li>
<li>Doesn't sort imports (but formats them)</li>
</ul>
</div>
</div>


<div id="outline-container-org9898aac" class="outline-2">
<h2 id="org9898aac">Code examples</h2>
<div class="outline-text-2" id="text-org9898aac">
<p>
There are several popular and wide known open source projects using black.
</p>

<p>
You can have a look at their code to get an idea how it will look.
</p>

<ul class="org-ul">
<li><a href="https://github.com/tox-dev/tox">Tox</a></li>
<li><a href="https://github.com/pytest-dev/pytest">Pytest</a></li>
</ul>
</div>
</div>


<div id="outline-container-orgbb95e15" class="outline-2">
<h2 id="orgbb95e15">Links</h2>
<div class="outline-text-2" id="text-orgbb95e15">
<ol class="org-ol">
<li><a href="https://github.com/psf/black">Github</a></li>
<li><a href="https://black.readthedocs.io/en/stable/">Docs</a></li>
<li><a href="https://www.youtube.com/watch?v=esZLCuWs_2Y&amp;feature=youtu.be">PyCon Talk</a></li>
<li><a href="https://black.now.sh/">Playground</a></li>
</ol>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr>
To get in touch, email me at <a href="mailto:reacsdas@gmail.com">reacsdas@gmail.com</a> <br /><br />
Discuss and comment in <a href="https://t.me/reacsdas">Telegram</a> | <a href="https://github.com/paul-nameless">Github</a> | <a href="https://twitter.com/paul_nameless">Twitter</a><br/>

<!-- Cloudflare Web Analytics -->
<script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "2c0ad197c226461eaccf6861b45f1cf8"}'>
</script>
<!-- End Cloudflare Web Analytics -->
</div>
</body>
</html>
